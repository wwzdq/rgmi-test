<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>多维人格魅力评估（SPCAS）</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background-color: #f8f9fa;
            color: #333;
            line-height: 1.6;
            max-width: 100%;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: white;
            min-height: 100vh;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.05);
        }
        
        /* 通用头部样式 */
        .header {
            text-align: center;
            padding: 20px 0;
            border-bottom: 1px solid #eaeaea;
            margin-bottom: 30px;
        }
        
        .header h1 {
            color: #2c3e50;
            font-size: 1.8rem;
            margin-bottom: 10px;
            font-weight: 700;
        }
        
        .header p {
            color: #7f8c8d;
            font-size: 1rem;
        }
        
        /* 卡片样式 */
        .card {
            background-color: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            border: 1px solid #eaeaea;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
        }
        
        .card-title {
            color: #3498db;
            font-size: 1.4rem;
            margin-bottom: 15px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .card-title i {
            color: #3498db;
        }
        
        /* 按钮样式 */
        .btn {
            display: inline-block;
            padding: 14px 28px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
            text-decoration: none;
            width: 100%;
            margin-top: 10px;
        }
        
        .btn:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.3);
        }
        
        .btn-primary {
            background-color: #3498db;
        }
        
        .btn-success {
            background-color: #2ecc71;
        }
        
        .btn-success:hover {
            background-color: #27ae60;
            box-shadow: 0 5px 15px rgba(46, 204, 113, 0.3);
        }
        
        .btn-warning {
            background-color: #f39c12;
        }
        
        .btn-warning:hover {
            background-color: #d68910;
            box-shadow: 0 5px 15px rgba(243, 156, 18, 0.3);
        }
        
        .btn-secondary {
            background-color: #95a5a6;
        }
        
        .btn-secondary:hover {
            background-color: #7f8c8d;
            box-shadow: 0 5px 15px rgba(149, 165, 166, 0.3);
        }
        
        .btn-info {
            background-color: #17a2b8;
        }
        
        .btn-info:hover {
            background-color: #138496;
            box-shadow: 0 5px 15px rgba(23, 162, 184, 0.3);
        }
        
        /* 首页样式 */
        #home {
            display: block;
        }
        
        .intro-section {
            margin-bottom: 30px;
        }
        
        .features {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .feature-item {
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }
        
        .feature-icon {
            background-color: #e3f2fd;
            color: #3498db;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }
        
        /* 测试页面样式 */
        #test, #result, #consult-modal {
            display: none;
        }
        
        .question-counter {
            text-align: center;
            font-size: 1rem;
            color: #7f8c8d;
            margin-bottom: 20px;
        }
        
        .question-text {
            font-size: 1.3rem;
            margin-bottom: 30px;
            color: #2c3e50;
            line-height: 1.5;
            font-weight: 500;
        }
        
        .options-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .option {
            padding: 18px 20px;
            border: 2px solid #eaeaea;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .option:hover {
            border-color: #3498db;
            background-color: #f0f8ff;
        }
        
        .option.selected {
            border-color: #3498db;
            background-color: #e3f2fd;
        }
        
        .option-number {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background-color: #f5f5f5;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: #333;
            flex-shrink: 0;
        }
        
        .option.selected .option-number {
            background-color: #3498db;
            color: white;
        }
        
        .test-navigation {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        
        .test-navigation .btn {
            margin-top: 0;
        }
        
        /* 结果页面样式 */
        .result-summary {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .result-score {
            font-size: 2.5rem;
            font-weight: 700;
            color: #2c3e50;
            margin: 10px 0;
        }
        
        .result-level {
            font-size: 1.5rem;
            color: #3498db;
            margin-bottom: 20px;
            font-weight: 600;
        }
        
        .radar-container {
            width: 100%;
            height: 350px;
            margin: 30px 0;
        }
        
        .dimension-results {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            margin-bottom: 30px;
        }
        
        @media (min-width: 600px) {
            .dimension-results {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        .dimension-item {
            padding: 15px;
            border-radius: 10px;
            background-color: #f9f9f9;
            border-left: 5px solid #3498db;
        }
        
        .dimension-score {
            font-size: 1.3rem;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 5px;
        }
        
        .dimension-name {
            font-size: 1.1rem;
            color: #3498db;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .dimension-level {
            font-size: 0.9rem;
            color: #7f8c8d;
            margin-bottom: 10px;
        }
        
        .report-section {
            margin-bottom: 30px;
        }
        
        .section-title {
            font-size: 1.3rem;
            color: #2c3e50;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid #f0f0f0;
            font-weight: 600;
        }
        
        .report-text {
            line-height: 1.7;
            color: #555;
            margin-bottom: 15px;
        }
        
        .action-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 30px;
        }
        
        /* 模态框样式 */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 20px;
        }
        
        .modal-content {
            background-color: white;
            border-radius: 12px;
            padding: 30px;
            max-width: 500px;
            width: 100%;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }
        
        .modal-title {
            font-size: 1.5rem;
            color: #2c3e50;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .modal-text {
            margin-bottom: 25px;
            color: #555;
            text-align: center;
            line-height: 1.6;
        }
        
        .modal-buttons {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        /* 页脚 */
        .footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #eaeaea;
            color: #7f8c8d;
            font-size: 0.9rem;
        }
        
        /* 响应式调整 */
        @media (max-width: 600px) {
            .container {
                padding: 15px;
            }
            
            .card {
                padding: 20px;
            }
            
            .card-title {
                font-size: 1.2rem;
            }
            
            .question-text {
                font-size: 1.2rem;
            }
            
            .option {
                padding: 15px;
            }
            
            .test-navigation {
                flex-direction: column;
            }
            
            .action-buttons {
                grid-template-columns: 1fr;
            }
            
            .result-score {
                font-size: 2rem;
            }
            
            .radar-container {
                height: 300px;
            }
        }
        
        /* 隐藏打印元素 */
        .no-print {
            display: block;
        }
        
        /* 图片生成专用样式 */
        .img-report-container {
            width: 800px;
            padding: 40px;
            background-color: white;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        .img-report-container .result-summary {
            margin-bottom: 30px;
        }
        
        .img-report-container .radar-container {
            height: 400px;
            margin: 30px 0;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .img-report-container .radar-img {
            max-width: 100%;
            height: auto;
            max-height: 400px;
        }
        
        .img-report-container .section-title {
            font-size: 1.3rem;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .img-report-container .report-text {
            line-height: 1.7;
            margin-bottom: 15px;
        }
        
        .img-report-container .dimension-results {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .img-report-container .dimension-item {
            padding: 15px;
            border-radius: 10px;
            background-color: #f9f9f9;
            border-left: 5px solid #3498db;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- 首页 -->
        <div id="home">
            <div class="header">
                <h1>多维人格魅力评估（SPCAS）</h1>
                <p>基于社会心理学与人格心理学的科学评估工具</p>
            </div>
            
            <div class="card intro-section">
                <div class="card-title"><i class="fas fa-info-circle"></i> 工具简介</div>
                <p class="report-text">
                    本量表基于班杜拉社会学习理论、麦克利兰成就动机理论、戈夫曼拟剧理论及大五人格理论构建，从6个核心维度科学评估个体的人格魅力水平。通过60道标准化题目，全面测量亲和力、影响力、情绪调控力、可信度、共情力和目标驱动力，帮助个体深入了解自身人格魅力的优势与提升空间。
                </p>
            </div>
            
            <div class="card">
                <div class="card-title"><i class="fas fa-star"></i> 量表特征</div>
                <div class="features">
                    <div class="feature-item">
                        <div class="feature-icon"><i class="fas fa-brain"></i></div>
                        <div>
                            <strong>科学理论基础</strong>
                            <p>基于多个人格心理学与社会心理学经典理论构建</p>
                        </div>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon"><i class="fas fa-ruler"></i></div>
                        <div>
                            <strong>多维度评估</strong>
                            <p>涵盖6个核心人格魅力维度，提供全面评估</p>
                        </div>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon"><i class="fas fa-chart-bar"></i></div>
                        <div>
                            <strong>可视化报告</strong>
                            <p>提供雷达图和详细分析报告，直观展示评估结果</p>
                        </div>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon"><i class="fas fa-lightbulb"></i></div>
                        <div>
                            <strong>个性化建议</strong>
                            <p>根据评估结果提供具体、可操作的改进建议</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <div class="card-title"><i class="fas fa-clipboard-check"></i> 作答要求</div>
                <p class="report-text">
                    1. 请根据您的实际情况选择最贴切的选项，而非您认为"应该"选择的答案。<br>
                    2. 每题有5个选项：1=完全不符合，2=不太符合，3=一般符合，4=比较符合，5=完全符合。<br>
                    3. 测试共60题，预计完成时间15-20分钟，请确保有充足时间完成。<br>
                    4. 测试结果仅用于自我认知与发展参考，请如实作答。<br>
                    5. 测试结束后，您将获得详细的评估报告和个性化建议。
                </p>
            </div>
            
            <button id="start-test" class="btn btn-primary">
                <i class="fas fa-play-circle"></i> 开始测试
            </button>
            
            <div class="footer">
                <p>© 2023 多维人格魅力评估（SPCAS） | 基于经典心理学理论构建</p>
            </div>
        </div>
        
        <!-- 测试页面 -->
        <div id="test">
            <div class="header">
                <h1>人格魅力评估测试</h1>
                <p>请根据您的实际情况选择最贴切的选项</p>
            </div>
            
            <div class="question-counter" id="question-counter">第 <span id="current-question">1</span> 题 / 共 60 题</div>
            
            <div class="card">
                <div class="question-text" id="question-text">题目加载中...</div>
                
                <div class="options-container" id="options-container">
                    <!-- 选项将通过JavaScript动态生成 -->
                </div>
                
                <div class="test-navigation">
                    <button id="prev-question" class="btn btn-info">
                        <i class="fas fa-arrow-left"></i> 上一题
                    </button>
                </div>
            </div>
            
            <div class="footer">
                <p>提示：选择选项后将自动跳转到下一题，也可使用"上一题"按钮返回修改</p>
            </div>
        </div>
        
        <!-- 结果页面 -->
        <div id="result">
            <div class="header">
                <h1>人格魅力评估报告</h1>
                <p>基于您的测试结果生成的个性化分析报告</p>
            </div>
            
            <!-- 报告内容区域（用于生成图片） -->
            <div id="report-content">
                <div class="result-summary">
                    <h2>您的评估结果</h2>
                    <div class="result-score" id="total-score">0/300</div>
                    <div class="result-level" id="total-level">基础型人格魅力</div>
                    <p class="report-text">评估日期: <span id="report-date">2023年11月15日</span></p>
                </div>
                
                <div class="radar-container">
                    <canvas id="radar-chart"></canvas>
                </div>
                
                <div class="section-title">各维度得分详情</div>
                <div class="dimension-results" id="dimension-results">
                    <!-- 维度结果将通过JavaScript动态生成 -->
                </div>
                
                <div class="report-section">
                    <div class="section-title">综合评估分析</div>
                    <div class="report-text" id="comprehensive-analysis">
                        <!-- 综合评估分析将通过JavaScript动态生成 -->
                    </div>
                </div>
                
                <div class="report-section">
                    <div class="section-title">个性化提升建议</div>
                    <div class="report-text" id="personal-suggestions">
                        <!-- 个性化建议将通过JavaScript动态生成 -->
                    </div>
                </div>
                
                <div class="footer no-print">
                    <p>© 2023 多维人格魅力评估（SPCAS） | 本报告仅用于个人发展参考</p>
                </div>
            </div>
            
            <!-- 操作按钮 -->
            <div class="action-buttons no-print">
                <div>
                    <button id="save-result" class="btn btn-success">
                        <i class="fas fa-download"></i> 保存结果
                    </button>
                </div>
                <div>
                    <button id="back-home" class="btn btn-secondary">
                        <i class="fas fa-home"></i> 回到首页
                    </button>
                </div>
                <div>
                    <button id="deep-consult" class="btn btn-warning">
                        <i class="fas fa-comments"></i> 深度咨询
                    </button>
                </div>
                <div>
                    <button id="more-tests" class="btn btn-primary">
                        <i class="fas fa-list"></i> 更多测试
                    </button>
                </div>
            </div>
        </div>
        
        <!-- 咨询确认模态框 -->
        <div id="consult-modal" class="modal-overlay">
            <div class="modal-content">
                <div class="modal-title">
                    <i class="fas fa-exclamation-triangle"></i> 温馨提示
                </div>
                <div class="modal-text">
                    为确保咨询效果，请先保存本次测试结果，然后联系客服提供您的评估报告，以便获得更具针对性的专业建议。
                </div>
                <div class="modal-buttons">
                    <button id="go-consult" class="btn btn-warning">
                        <i class="fas fa-check-circle"></i> 我已保存，去咨询
                    </button>
                    <button id="go-save" class="btn btn-secondary">
                        <i class="fas fa-save"></i> 去保存
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 题目数据 - 60道题目，分为6个维度
        const questions = [
            // 维度1: 亲和力 (10题)
            { id: 1, dimension: "亲和力", text: "与陌生人交流时，我能快速让对方感到放松" },
            { id: 2, dimension: "亲和力", text: "他人向我倾诉烦恼时，我会耐心倾听并给予理解" },
            { id: 3, dimension: "亲和力", text: "我习惯用微笑、点头等肢体语言回应他人的互动" },
            { id: 4, dimension: "亲和力", text: "即使与观点不同的人相处，我也能保持友好态度" },
            { id: 5, dimension: "亲和力", text: "周围人遇到困难时，我会主动提供力所能及的帮助" },
            { id: 6, dimension: "亲和力", text: "我的语言表达温和，很少使用生硬或攻击性的词汇" },
            { id: 7, dimension: "亲和力", text: "我能快速记住他人的名字和关键信息（如喜好、职业）" },
            { id: 8, dimension: "亲和力", text: "在团队中，我更倾向于协调矛盾而非激化冲突" },
            { id: 9, dimension: "亲和力", text: "他人取得成就时，我会真诚地表达赞美和祝福" },
            { id: 10, dimension: "亲和力", text: "与他人相处时，我会主动关注对方的情绪变化" },
            
            // 维度2: 影响力 (10题)
            { id: 11, dimension: "影响力", text: "当团队面临决策困境时，我能提出有说服力的建议" },
            { id: 12, dimension: "影响力", text: "我的行为和态度会被身边人模仿或参考" },
            { id: 13, dimension: "影响力", text: "在公开场合发言时，我能吸引他人的注意力" },
            { id: 14, dimension: "影响力", text: "我能清晰地传递自己的观点，同时让他人愿意接受" },
            { id: 15, dimension: "影响力", text: "面对质疑时，我能坚定地维护自己的合理立场" },
            { id: 16, dimension: "影响力", text: "我善于用目标或愿景激励身边的人共同努力" },
            { id: 17, dimension: "影响力", text: "他人会主动向我咨询意见或寻求指导" },
            { id: 18, dimension: "影响力", text: "我能在复杂情境中快速做出判断并引导他人跟进" },
            { id: 19, dimension: "影响力", text: "我的职业或专业能力能让他人产生信任感" },
            { id: 20, dimension: "影响力", text: "我能通过自身行动带动团队氛围的提升" },
            
            // 维度3: 情绪调控力 (10题)
            { id: 21, dimension: "情绪调控力", text: "即使遇到突发状况，我也能保持冷静不慌乱" },
            { id: 22, dimension: "情绪调控力", text: "当我感到愤怒或焦虑时，能快速调整情绪状态" },
            { id: 23, dimension: "情绪调控力", text: "我不会将负面情绪随意发泄到他人身上" },
            { id: 24, dimension: "情绪调控力", text: "面对挫折时，我能积极调整心态寻找解决办法" },
            { id: 25, dimension: "情绪调控力", text: "我能清晰地感知自己的情绪变化并及时疏导" },
            { id: 26, dimension: "情绪调控力", text: "在高压环境下，我依然能保证工作或社交的效率" },
            { id: 27, dimension: "情绪调控力", text: "我不会因为他人的负面评价而过度否定自己" },
            { id: 28, dimension: "情绪调控力", text: "与他人发生矛盾时，我能先平复情绪再沟通解决" },
            { id: 29, dimension: "情绪调控力", text: "我有固定的情绪调节方式（如运动、阅读）并能有效使用" },
            { id: 30, dimension: "情绪调控力", text: "即使心情低落，我也能维持基本的社交礼仪" },
            
            // 维度4: 可信度 (10题)
            { id: 31, dimension: "可信度", text: "我承诺的事情一定会尽力做到，不轻易食言" },
            { id: 32, dimension: "可信度", text: "我不会编造谎言或夸大事实来美化自己" },
            { id: 33, dimension: "可信度", text: "面对错误时，我会主动承认并承担相应责任" },
            { id: 34, dimension: "可信度", text: "我会妥善保管他人托付的秘密，不随意泄露" },
            { id: 35, dimension: "可信度", text: "我的言行一致，不会出现'说一套做一套'的情况" },
            { id: 36, dimension: "可信度", text: "我会客观评价自己的能力，不盲目自信或自卑" },
            { id: 37, dimension: "可信度", text: "与他人合作时，我会认真履行自己的职责分工" },
            { id: 38, dimension: "可信度", text: "我不会为了个人利益损害他人或集体的利益" },
            { id: 39, dimension: "可信度", text: "他人向我求助时，我会根据自身能力如实回应，不敷衍" },
            { id: 40, dimension: "可信度", text: "我会主动向他人反馈事情的进展，让对方放心" },
            
            // 维度5: 共情力 (10题)
            { id: 41, dimension: "共情力", text: "我能快速理解他人的处境和感受，感同身受" },
            { id: 42, dimension: "共情力", text: "与他人交流时，我会主动换位思考，站在对方角度考虑问题" },
            { id: 43, dimension: "共情力", text: "我能从他人的语气、肢体语言中捕捉到隐藏的情绪" },
            { id: 44, dimension: "共情力", text: "当他人感到痛苦时，我会主动给予安慰和支持" },
            { id: 45, dimension: "共情力", text: "我会关注他人的需求，并尽力配合满足合理需求" },
            { id: 46, dimension: "共情力", text: "面对他人的不幸，我会产生真诚的同情而非冷漠" },
            { id: 47, dimension: "共情力", text: "我能理解他人的选择，即使不符合自己的价值观" },
            { id: 48, dimension: "共情力", text: "与他人产生分歧时，我会先倾听对方的理由再表达观点" },
            { id: 49, dimension: "共情力", text: "我会主动询问他人的感受，避免忽略对方的情绪需求" },
            { id: 50, dimension: "共情力", text: "我能准确回应他人的情绪信号，让对方感到被理解" },
            
            // 维度6: 目标驱动力 (10题)
            { id: 51, dimension: "目标驱动力", text: "我有清晰的短期和长期目标，并会制定计划推进实现" },
            { id: 52, dimension: "目标驱动力", text: "面对困难时，我不会轻易放弃，会坚持完成既定目标" },
            { id: 53, dimension: "目标驱动力", text: "我会主动学习新知识、新技能，提升自己实现目标的能力" },
            { id: 54, dimension: "目标驱动力", text: "我能合理分配时间和精力，提高目标推进的效率" },
            { id: 55, dimension: "目标驱动力", text: "当目标完成时，我会总结经验并设定更高的目标" },
            { id: 56, dimension: "目标驱动力", text: "即使没有他人监督，我也能主动推进目标的实现" },
            { id: 57, dimension: "目标驱动力", text: "我会根据实际情况调整目标和计划，确保可行性" },
            { id: 58, dimension: "目标驱动力", text: "我能在多个目标中分清主次，优先推进关键目标" },
            { id: 59, dimension: "目标驱动力", text: "实现目标的过程中，我会主动寻求他人的合作与支持" },
            { id: 60, dimension: "目标驱动力", text: "我会为自己的目标付出持续的努力，不急于求成" }
        ];
        
        // 维度信息
        const dimensions = [
            { name: "亲和力", maxScore: 50, description: "建立友好人际关系的能力" },
            { name: "影响力", maxScore: 50, description: "引导和说服他人的能力" },
            { name: "情绪调控力", maxScore: 50, description: "管理和调节自身情绪的能力" },
            { name: "可信度", maxScore: 50, description: "建立信任和可靠形象的能力" },
            { name: "共情力", maxScore: 50, description: "理解和分享他人感受的能力" },
            { name: "目标驱动力", maxScore: 50, description: "设定和追求目标的能力" }
        ];
        
        // 答案选项
        const answerOptions = [
            { value: 1, text: "完全不符合" },
            { value: 2, text: "不太符合" },
            { value: 3, text: "一般符合" },
            { value: 4, text: "比较符合" },
            { value: 5, text: "完全符合" }
        ];
        
        // 全局变量
        let currentQuestionIndex = 0;
        let userAnswers = new Array(questions.length).fill(0);
        let dimensionScores = {
            "亲和力": 0,
            "影响力": 0,
            "情绪调控力": 0,
            "可信度": 0,
            "共情力": 0,
            "目标驱动力": 0
        };
        let radarChart = null;
        let radarChartData = null;
        let radarImageDataURL = null;
        
        // DOM元素
        const homePage = document.getElementById('home');
        const testPage = document.getElementById('test');
        const resultPage = document.getElementById('result');
        const consultModal = document.getElementById('consult-modal');
        const startTestBtn = document.getElementById('start-test');
        const questionText = document.getElementById('question-text');
        const questionCounter = document.getElementById('question-counter');
        const currentQuestionSpan = document.getElementById('current-question');
        const optionsContainer = document.getElementById('options-container');
        const prevQuestionBtn = document.getElementById('prev-question');
        const saveResultBtn = document.getElementById('save-result');
        const backHomeBtn = document.getElementById('back-home');
        const deepConsultBtn = document.getElementById('deep-consult');
        const moreTestsBtn = document.getElementById('more-tests');
        const goConsultBtn = document.getElementById('go-consult');
        const goSaveBtn = document.getElementById('go-save');
        const reportDate = document.getElementById('report-date');
        
        // 设置报告日期
        const today = new Date();
        reportDate.textContent = `${today.getFullYear()}年${today.getMonth()+1}月${today.getDate()}日`;
        
        // 开始测试
        startTestBtn.addEventListener('click', () => {
            homePage.style.display = 'none';
            testPage.style.display = 'block';
            showQuestion(currentQuestionIndex);
        });
        
        // 显示问题
        function showQuestion(index) {
            const question = questions[index];
            questionText.textContent = `${question.id}. ${question.text}`;
            currentQuestionSpan.textContent = index + 1;
            
            // 更新上一题按钮状态
            prevQuestionBtn.style.display = index === 0 ? 'none' : 'block';
            
            // 清空选项容器
            optionsContainer.innerHTML = '';
            
            // 创建选项
            answerOptions.forEach(option => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                if (userAnswers[index] === option.value) {
                    optionElement.classList.add('selected');
                }
                
                optionElement.innerHTML = `
                    <div class="option-number">${option.value}</div>
                    <div class="option-text">${option.text}</div>
                `;
                
                optionElement.addEventListener('click', () => {
                    // 更新答案
                    userAnswers[index] = option.value;
                    
                    // 如果是最后一题，不自动跳转，等待用户点击查看结果
                    if (index === questions.length - 1) {
                        // 标记所有选项为未选中
                        document.querySelectorAll('.option').forEach(opt => {
                            opt.classList.remove('selected');
                        });
                        // 标记当前选项为选中
                        optionElement.classList.add('selected');
                        
                        // 显示查看结果按钮
                        showResultButton();
                    } else {
                        // 自动跳转到下一题
                        setTimeout(() => {
                            currentQuestionIndex++;
                            showQuestion(currentQuestionIndex);
                        }, 300);
                    }
                });
                
                optionsContainer.appendChild(optionElement);
            });
            
            // 如果是最后一题，确保没有查看结果按钮
            if (index === questions.length - 1) {
                const existingResultBtn = document.querySelector('.result-button');
                if (existingResultBtn) {
                    existingResultBtn.remove();
                }
            }
        }
        
        // 上一题按钮事件
        prevQuestionBtn.addEventListener('click', () => {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                showQuestion(currentQuestionIndex);
            }
        });
        
        // 显示查看结果按钮（仅最后一题）
        function showResultButton() {
            // 检查是否已经存在结果按钮
            const existingResultBtn = document.querySelector('.result-button');
            if (existingResultBtn) return;
            
            const resultButton = document.createElement('button');
            resultButton.className = 'btn btn-success result-button';
            resultButton.innerHTML = '<i class="fas fa-chart-bar"></i> 查看结果';
            resultButton.style.marginTop = '20px';
            
            resultButton.addEventListener('click', () => {
                calculateResults();
                testPage.style.display = 'none';
                resultPage.style.display = 'block';
                displayResults();
            });
            
            optionsContainer.parentNode.appendChild(resultButton);
        }
        
        // 计算测试结果
        function calculateResults() {
            // 重置维度分数
            for (let dim in dimensionScores) {
                dimensionScores[dim] = 0;
            }
            
            // 计算每个维度的分数
            questions.forEach((question, index) => {
                const answer = userAnswers[index];
                dimensionScores[question.dimension] += answer;
            });
        }
        
        // 显示测试结果
        function displayResults() {
            // 计算总分
            let totalScore = 0;
            for (let dim in dimensionScores) {
                totalScore += dimensionScores[dim];
            }
            
            // 显示总分
            document.getElementById('total-score').textContent = `${totalScore}/300`;
            
            // 确定总分等级
            let totalLevel = "";
            let levelDescription = "";
            
            if (totalScore <= 120) {
                totalLevel = "基础型人格魅力";
                levelDescription = "人格魅力基础较弱，在社交中较难形成正向吸引力，需全面提升各维度特质。在人际关系中容易处于被动地位，难以建立深层次的社交关系；职业发展中可能因影响力不足、目标驱动力弱而难以获得晋升机会。核心问题在于对自我认知不足，缺乏主动提升人格魅力的意识和方法。";
            } else if (totalScore <= 180) {
                totalLevel = "成长型人格魅力";
                levelDescription = "具备基本的人格魅力特质，部分维度表现中等，能在熟悉的环境中展现一定的吸引力。但人格魅力的稳定性不足，在陌生环境、高压情境或复杂人际互动中容易出现短板。核心问题在于人格魅力的'全面性'和'稳定性'有待提升，部分维度存在明显短板。";
            } else if (totalScore <= 240) {
                totalLevel = "成熟型人格魅力";
                levelDescription = "人格魅力较为成熟，多数维度表现中等偏上，核心维度表现突出，能在多数社交和工作场景中形成正向影响力。核心优势在于人格魅力的'均衡性'和'实用性'，能有效适配多数社交与职业场景。但可能在个别维度存在小幅短板，在极端复杂的情境中可能出现魅力'波动'。";
            } else {
                totalLevel = "卓越型人格魅力";
                levelDescription = "人格魅力达到卓越水平，各维度表现普遍突出，无明显短板，具备强烈的正向吸引力和影响力。核心优势在于人格魅力的'全面性''稳定性'和'感染力'，能适配所有社交与职业场景，甚至能通过自身魅力带动周围环境的正向发展。";
            }
            
            document.getElementById('total-level').textContent = totalLevel;
            
            // 生成维度结果HTML
            const dimensionResultsContainer = document.getElementById('dimension-results');
            dimensionResultsContainer.innerHTML = '';
            
            const dimensionData = [];
            const dimensionLabels = [];
            
            for (let dim in dimensionScores) {
                const score = dimensionScores[dim];
                let level = "";
                let levelDesc = "";
                
                if (score <= 20) {
                    level = "低水平";
                    levelDesc = "该维度特质表现较弱，存在明显提升空间";
                } else if (score <= 35) {
                    level = "中等水平";
                    levelDesc = "该维度特质表现适中，基本能满足日常社交与工作需求";
                } else {
                    level = "高水平";
                    levelDesc = "该维度特质表现突出，是人格魅力的核心优势";
                }
                
                // 为雷达图准备数据
                dimensionData.push(score);
                dimensionLabels.push(dim);
                
                // 创建维度结果元素
                const dimensionElement = document.createElement('div');
                dimensionElement.className = 'dimension-item';
                dimensionElement.innerHTML = `
                    <div class="dimension-name">${dim}</div>
                    <div class="dimension-score">${score}/50</div>
                    <div class="dimension-level">${level} - ${levelDesc}</div>
                `;
                
                dimensionResultsContainer.appendChild(dimensionElement);
            }
            
            // 保存雷达图数据用于图片生成
            radarChartData = {
                labels: dimensionLabels,
                data: dimensionData
            };
            
            // 绘制雷达图
            drawRadarChart(dimensionLabels, dimensionData);
            
            // 生成综合评估分析
            const comprehensiveAnalysis = document.getElementById('comprehensive-analysis');
            comprehensiveAnalysis.innerHTML = `
                <p><strong>${totalLevel} (${totalScore}/300)</strong></p>
                <p>${levelDescription}</p>
                <p>根据您的测试结果，您的人格魅力在以下方面表现突出：${getTopDimensions(dimensionScores)}。</p>
                <p>需要关注的提升领域：${getBottomDimensions(dimensionScores)}。</p>
                <p>建议您结合各维度的详细分析和建议，制定个人提升计划，持续优化自己的人格魅力。</p>
            `;
            
            // 生成个性化建议
            const personalSuggestions = document.getElementById('personal-suggestions');
            personalSuggestions.innerHTML = generatePersonalSuggestions(dimensionScores, totalScore);
        }
        
        // 获取得分最高的维度
        function getTopDimensions(scores) {
            const sorted = Object.entries(scores).sort((a, b) => b[1] - a[1]);
            const topDimensions = sorted.slice(0, 2).map(item => item[0]);
            return topDimensions.length > 0 ? topDimensions.join('、') : "暂无";
        }
        
        // 获取得分最低的维度
        function getBottomDimensions(scores) {
            const sorted = Object.entries(scores).sort((a, b) => a[1] - b[1]);
            const bottomDimensions = sorted.slice(0, 2).map(item => item[0]);
            return bottomDimensions.length > 0 ? bottomDimensions.join('、') : "暂无";
        }
        
        // 生成个性化建议
        function generatePersonalSuggestions(scores, totalScore) {
            let suggestions = "";
            
            // 根据总分等级确定整体建议
            if (totalScore <= 120) {
                suggestions = `
                    <p><strong>整体提升方向：全面筑基，重点突破</strong></p>
                    <p>建议优先选择2-3个核心维度（如可信度、情绪调控力、亲和力）进行重点提升，避免全面铺开导致精力分散。</p>
                    <p>制定3个月的短期提升计划，每个维度每周安排1-2个具体行动（如每周练习3次情绪调节、每天进行1次主动社交），定期复盘提升效果。</p>
                    <p>加强自我认知，通过阅读人格心理学相关书籍、向身边优秀的人学习，提升对人格魅力的理解和提升意识。</p>
                `;
            } else if (totalScore <= 180) {
                suggestions = `
                    <p><strong>整体提升方向：补齐短板，强化优势</strong></p>
                    <p>先梳理自己的短板维度，针对性地制定提升计划；同时，强化自己的优势维度，让优势更突出。</p>
                    <p>参与团队项目、社交活动等实践场景，在实践中提升人格魅力的稳定性。</p>
                    <p>可以加入学习小组或寻找mentor，定期获得反馈和指导，加速提升进程。</p>
                    <p>关注不同场景下的人格魅力适配性，提升在陌生环境和高压情境中的表现。</p>
                `;
            } else if (totalScore <= 240) {
                suggestions = `
                    <p><strong>整体提升方向：均衡优化，场景深耕</strong></p>
                    <p>针对个别短板维度进行小幅优化，提升人格魅力的全面性。</p>
                    <p>重点深耕不同场景（如职场管理、跨行业合作、公共演讲），让人格魅力在特定场景中发挥更大作用。</p>
                    <p>尝试担任团队领导、项目负责人等角色，锻炼领导力和影响力；参与跨领域的交流活动，提升跨文化、跨行业的社交能力。</p>
                    <p>总结自己的人格魅力提升经验，形成个性化的提升方法，保持持续优化的状态。</p>
                `;
            } else {
                suggestions = `
                    <p><strong>整体提升方向：价值引领，辐射影响</strong></p>
                    <p>将人格魅力与个人价值、社会价值结合，通过自身的影响力带动周围环境的正向发展。</p>
                    <p>分享自己的人格魅力提升经验，开展培训、讲座等活动，帮助更多人提升人格魅力。</p>
                    <p>参与公益事业、行业建设等活动，在更大的平台上发挥影响力。</p>
                    <p>保持谦逊的态度，持续关注自身的细微不足，不断精进，让人格魅力始终保持在卓越水平。</p>
                `;
            }
            
            // 为每个维度添加具体建议
            suggestions += "<p><strong>各维度具体建议：</strong></p>";
            
            for (let dim in scores) {
                const score = scores[dim];
                let dimSuggestions = "";
                
                if (score <= 20) {
                    // 低水平建议
                    if (dim === "亲和力") {
                        dimSuggestions = "每天练习微笑5分钟，调整肢体语言；每天主动与1-2个陌生人进行简单交流；学习主动倾听技巧。";
                    } else if (dim === "影响力") {
                        dimSuggestions = "每天进行10分钟观点表达练习；积累专业知识提升观点含金量；在熟悉群体中主动提出建议。";
                    } else if (dim === "情绪调控力") {
                        dimSuggestions = "每天记录情绪状态；采用深呼吸法平复情绪；培养情绪疏导爱好如运动、绘画。";
                    } else if (dim === "可信度") {
                        dimSuggestions = "从承诺小事做起确保兑现；出现错误时第一时间承认并道歉；与他人合作时主动反馈进展。";
                    } else if (dim === "共情力") {
                        dimSuggestions = "每天观察1-2个人的情绪状态；强制自己站在对方角度思考；学习使用共情句式。";
                    } else if (dim === "目标驱动力") {
                        dimSuggestions = "制定3个短期小目标；将目标拆解为每天的小任务；每天记录目标推进进度。";
                    }
                } else if (score <= 35) {
                    // 中等水平建议
                    if (dim === "亲和力") {
                        dimSuggestions = "根据不同场景调整亲和力表达方式；在交流中主动分享真实感受；学习冲突协调技巧。";
                    } else if (dim === "影响力") {
                        dimSuggestions = "学习结构化表达方法如PREP法；在自己的专业领域深入学习；主动承担团队中的小项目。";
                    } else if (dim === "情绪调控力") {
                        dimSuggestions = "主动挑战有难度的任务锻炼情绪稳定性；学习情绪隔离技巧；定期进行情绪复盘。";
                    } else if (dim === "可信度") {
                        dimSuggestions = "针对长期任务制定阶段性目标并定期反馈；处理利益冲突时优先选择诚信原则；建立个人品牌。";
                    } else if (dim === "共情力") {
                        dimSuggestions = "学习解读微表情和微动作；根据不同人的性格特点调整共情方式；区分共情和过度共情。";
                    } else if (dim === "目标驱动力") {
                        dimSuggestions = "在短期目标基础上制定长期目标；学习时间管理技巧如番茄工作法；当遇到挫折时进行分析复盘。";
                    }
                } else {
                    // 高水平建议
                    if (dim === "亲和力") {
                        dimSuggestions = "提升在不同文化、年龄、职业群体中的亲和力；将亲和力与影响力结合实现柔性影响；发挥亲和力优势帮助他人提升社交能力。";
                    } else if (dim === "影响力") {
                        dimSuggestions = "从战术影响向战略影响转变；尝试影响不同部门、不同领域的团队；通过自身行为传递正向价值观。";
                    } else if (dim === "情绪调控力") {
                        dimSuggestions = "主动引导他人的情绪实现情绪赋能；模拟极端情境制定情绪应对预案；学习情绪智慧相关理论。";
                    } else if (dim === "可信度") {
                        dimSuggestions = "在重大危机或利益诱惑面前坚守诚信原则；利用自己的可信度搭建他人之间的信任桥梁；成为行业诚信标杆。";
                    } else if (dim === "共情力") {
                        dimSuggestions = "引导他人梳理自己的情绪；学习不同文化背景下的情绪表达差异；在决策过程中融入共情思维。";
                    } else if (dim === "目标驱动力") {
                        dimSuggestions = "将个人目标与团队目标、社会价值结合；在推进目标过程中尝试新方法新思路；制定具有前瞻性的长期愿景。";
                    }
                }
                
                suggestions += `<p><strong>${dim} (${score}/50)：</strong> ${dimSuggestions}</p>`;
            }
            
            return suggestions;
        }
        
        // 绘制雷达图
        function drawRadarChart(labels, data) {
            const ctx = document.getElementById('radar-chart').getContext('2d');
            
            // 如果已经存在图表实例，销毁它
            if (radarChart) {
                radarChart.destroy();
            }
            
            radarChart = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: '维度得分',
                        data: data,
                        backgroundColor: 'rgba(52, 152, 219, 0.2)',
                        borderColor: 'rgba(52, 152, 219, 1)',
                        pointBackgroundColor: 'rgba(52, 152, 219, 1)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgba(52, 152, 219, 1)',
                        borderWidth: 2,
                        pointRadius: 4
                    }]
                },
                options: {
                    scales: {
                        r: {
                            angleLines: {
                                display: true,
                                color: 'rgba(0, 0, 0, 0.1)'
                            },
                            suggestedMin: 0,
                            suggestedMax: 50,
                            ticks: {
                                stepSize: 10,
                                backdropColor: 'transparent'
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            },
                            pointLabels: {
                                font: {
                                    size: 13,
                                    weight: 'bold'
                                },
                                color: '#2c3e50'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
            
            // 将雷达图转换为Base64图片
            setTimeout(() => {
                radarImageDataURL = radarChart.toBase64Image();
            }, 500);
        }
        
        // 保存结果为图片
        saveResultBtn.addEventListener('click', () => {
            // 计算总分
            let totalScore = 0;
            for (let dim in dimensionScores) {
                totalScore += dimensionScores[dim];
            }
            
            // 确定总分等级
            let totalLevel = "";
            if (totalScore <= 120) {
                totalLevel = "基础型人格魅力";
            } else if (totalScore <= 180) {
                totalLevel = "成长型人格魅力";
            } else if (totalScore <= 240) {
                totalLevel = "成熟型人格魅力";
            } else {
                totalLevel = "卓越型人格魅力";
            }
            
            // 生成雷达图图片HTML
            const radarImageHTML = radarImageDataURL ? 
                `<img src="${radarImageDataURL}" alt="雷达图" class="radar-img" />` : 
                '<div style="text-align:center; color:#7f8c8d; padding: 20px;">雷达图生成中...</div>';
            
            // 创建用于生成图片的报告HTML
            const reportHTML = `
                <div class="img-report-container">
                    <div class="result-summary">
                        <h2>多维人格魅力评估（SPCAS）报告</h2>
                        <div class="result-score">${totalScore}/300</div>
                        <div class="result-level">${totalLevel}</div>
                        <p class="report-text">评估日期: ${today.getFullYear()}年${today.getMonth()+1}月${today.getDate()}日</p>
                    </div>
                    
                    <div class="radar-container">
                        ${radarImageHTML}
                    </div>
                    
                    <div class="section-title">各维度得分详情</div>
                    <div class="dimension-results">
                        ${Object.entries(dimensionScores).map(([dim, score]) => {
                            let level = "";
                            let levelDesc = "";
                            
                            if (score <= 20) {
                                level = "低水平";
                                levelDesc = "该维度特质表现较弱，存在明显提升空间";
                            } else if (score <= 35) {
                                level = "中等水平";
                                levelDesc = "该维度特质表现适中，基本能满足日常社交与工作需求";
                            } else {
                                level = "高水平";
                                levelDesc = "该维度特质表现突出，是人格魅力的核心优势";
                            }
                            
                            return `
                                <div class="dimension-item">
                                    <div class="dimension-name">${dim}</div>
                                    <div class="dimension-score">${score}/50</div>
                                    <div class="dimension-level">${level} - ${levelDesc}</div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                    
                    <div class="report-section">
                        <div class="section-title">综合评估分析</div>
                        <div class="report-text">
                            <p><strong>${totalLevel} (${totalScore}/300)</strong></p>
                            <p>${getLevelDescription(totalScore)}</p>
                            <p>根据您的测试结果，您的人格魅力在以下方面表现突出：${getTopDimensions(dimensionScores)}。</p>
                            <p>需要关注的提升领域：${getBottomDimensions(dimensionScores)}。</p>
                            <p>建议您结合各维度的详细分析和建议，制定个人提升计划，持续优化自己的人格魅力。</p>
                        </div>
                    </div>
                    
                    <div class="report-section">
                        <div class="section-title">个性化提升建议</div>
                        <div class="report-text">
                            ${generatePersonalSuggestions(dimensionScores, totalScore)}
                        </div>
                    </div>
                    
                    <div class="footer">
                        <p>© 2023 多维人格魅力评估（SPCAS） | 本报告仅用于个人发展参考</p>
                    </div>
                </div>
            `;
            
            // 创建临时容器
            const tempContainer = document.createElement('div');
            tempContainer.style.position = 'absolute';
            tempContainer.style.left = '-10000px';
            tempContainer.style.top = '0';
            tempContainer.style.width = '800px';
            tempContainer.style.backgroundColor = 'white';
            tempContainer.innerHTML = reportHTML;
            document.body.appendChild(tempContainer);
            
            // 使用html2canvas生成图片
            html2canvas(tempContainer, {
                scale: 2,
                useCORS: true,
                logging: false,
                backgroundColor: '#ffffff',
                width: 800,
                windowWidth: 800
            }).then(canvas => {
                // 将canvas转换为图片
                const imgData = canvas.toDataURL('image/png');
                
                // 创建下载链接
                const link = document.createElement('a');
                link.download = `多维人格魅力评估报告_${today.getFullYear()}${today.getMonth()+1}${today.getDate()}.png`;
                link.href = imgData;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                // 移除临时容器
                document.body.removeChild(tempContainer);
                
                // 显示保存成功提示
                alert('报告已保存为图片，您可以将其用于个人发展参考或咨询使用。');
            }).catch(error => {
                console.error('保存图片时出错:', error);
                alert('保存失败，请重试或截图保存。');
                
                // 确保临时容器被移除
                if (document.body.contains(tempContainer)) {
                    document.body.removeChild(tempContainer);
                }
            });
        });
        
        // 获取等级描述
        function getLevelDescription(totalScore) {
            if (totalScore <= 120) {
                return "人格魅力基础较弱，在社交中较难形成正向吸引力，需全面提升各维度特质。在人际关系中容易处于被动地位，难以建立深层次的社交关系；职业发展中可能因影响力不足、目标驱动力弱而难以获得晋升机会。核心问题在于对自我认知不足，缺乏主动提升人格魅力的意识和方法。";
            } else if (totalScore <= 180) {
                return "具备基本的人格魅力特质，部分维度表现中等，能在熟悉的环境中展现一定的吸引力。但人格魅力的稳定性不足，在陌生环境、高压情境或复杂人际互动中容易出现短板。核心问题在于人格魅力的'全面性'和'稳定性'有待提升，部分维度存在明显短板。";
            } else if (totalScore <= 240) {
                return "人格魅力较为成熟，多数维度表现中等偏上，核心维度表现突出，能在多数社交和工作场景中形成正向影响力。核心优势在于人格魅力的'均衡性'和'实用性'，能有效适配多数社交与职业场景。但可能在个别维度存在小幅短板，在极端复杂的情境中可能出现魅力'波动'。";
            } else {
                return "人格魅力达到卓越水平，各维度表现普遍突出，无明显短板，具备强烈的正向吸引力和影响力。核心优势在于人格魅力的'全面性''稳定性'和'感染力'，能适配所有社交与职业场景，甚至能通过自身魅力带动周围环境的正向发展。";
            }
        }
        
        // 返回首页
        backHomeBtn.addEventListener('click', () => {
            resultPage.style.display = 'none';
            homePage.style.display = 'block';
            
            // 重置测试状态
            currentQuestionIndex = 0;
            userAnswers = new Array(questions.length).fill(0);
        });
        
        // 深度咨询按钮
        deepConsultBtn.addEventListener('click', () => {
            consultModal.style.display = 'flex';
        });
        
        // 更多测试按钮
        moreTestsBtn.addEventListener('click', () => {
            window.open('https://xhslink.com/m/genPHyd6j0', '_blank');
        });
        
        // 模态框中的去咨询按钮
        goConsultBtn.addEventListener('click', () => {
            window.open('https://xhslink.com/m/genPHyd6j0', '_blank');
            consultModal.style.display = 'none';
        });
        
        // 模态框中的去保存按钮
        goSaveBtn.addEventListener('click', () => {
            consultModal.style.display = 'none';
        });
        
        // 初始化页面
        window.addEventListener('DOMContentLoaded', () => {
            // 初始显示首页
            homePage.style.display = 'block';
            testPage.style.display = 'none';
            resultPage.style.display = 'none';
            consultModal.style.display = 'none';
        });
    </script>
</body>
</html>